<template name="messages">
  {{#if currentUser}}
    <div class="container">
      <div class="row">
        <form class="newConversation">
          <div class="col-xs-6 input-group panel panel-default pull-right">
              <input type="text" name="username" placeholder="Enter an existing user's username and start a conversation!" class="form-control">
              <span class="input-group-btn">
                  <button type="submit" class="btn btn-primary"><span class="glyphicon glyphicon-plus"></span></button>
              </span>
          </div>
        </form>
      </div>
      {{#if hasConversations}}
        {{#each currentUser.conversations}}
          <div class="row">
            <div class="panel panel-default">
              <div class="panel-heading">
                {{#each participants}}
                    <a href={{pathToUserProfile}}><h4 class="pull-left">{{user.username}}</h4></a>
                {{/each}}
                <button class="btn-danger btn pull-right deleteConversation">Delete</button>
                <div class="clearfix"></div>
              </div>
              <div class="conversation panel-body">
                {{#with lastMessage}}
                  <div class="col-xs-1">
                      <h4>{{user.username}}:</h4>
                  </div>
                  <div class="col-xs-11">
                      <h4>{{body}}</h4>
                  </div>
                {{/with}}
              </div>  
            </div>
          </div>
        {{/each}}
      {{else}}
        <div class="row">
          <div class="panel panel-default">
            <div class="panel-body">
              <h5>Looks like you don't have any conversations! Either initiate a conversation above, or a conversation will be initiated automatically when you accept a user's borrow request.</h5>
            </div>
          </div>
        </div>
      {{/if}}
    </div>
  {{/if}}
</template>